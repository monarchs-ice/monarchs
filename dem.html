

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Running MONARCHS with a Digital Elevation Model (DEM) &mdash; MONARCHS  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Generating plots" href="plots.html" />
    <link rel="prev" title="Setting up your own model run" href="MONARCHS_model_setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MONARCHS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing MONARCHS</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Running MONARCHS (a quickstart guide)</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Tips and tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="MONARCHS_model_setup.html">Setting up your own model run</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running MONARCHS with a Digital Elevation Model (DEM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#selecting-a-subset-of-the-dem">Selecting a subset of the DEM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plots.html">Generating plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="met_data.html">Formatting input meteorological data</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_setup_reference.html"><code class="docutils literal notranslate"><span class="pre">model_setup</span></code> variable reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="common_errors.html">Common errors and debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_changes.html">Making changes to MONARCHS</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Code structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MONARCHS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Running MONARCHS with a Digital Elevation Model (DEM)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dem.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="running-monarchs-with-a-digital-elevation-model-dem">
<h1>Running MONARCHS with a Digital Elevation Model (DEM)<a class="headerlink" href="#running-monarchs-with-a-digital-elevation-model-dem" title="Link to this heading"></a></h1>
<p>In the previous examples (see <a class="reference internal" href="quickstart.html"><span class="doc">Running MONARCHS (a quickstart guide)</span></a>), we have been running MONARCHS using a user-generated firn profile -
either a single value for our 1D case, or a profile generated from a Python function in our 2D Gaussian lakes case.
In the previous cases, we use the <code class="docutils literal notranslate"><span class="pre">firn_depth</span></code> variable, and supply it either a single value or a 2D <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array.</p>
<p>In this example, we instead use the <code class="docutils literal notranslate"><span class="pre">dem_path</span></code> variable to specify a path to a Digital Elevation Model (DEM) file.
The presence of this variable will override the <code class="docutils literal notranslate"><span class="pre">firn_depth</span></code> variable if present, and the model will use the DEM to generate
the initial firn height distribution.</p>
<p>MONARCHS supports DEMs in <code class="docutils literal notranslate"><span class="pre">.tif</span></code> format, and uses <a class="reference external" href="https://rasterio.readthedocs.io/en/latest/">rasterio</a> to process
these. An example DEM for the George VI ice shelf is available at
<a class="reference external" href="https://data.pgc.umn.edu/elev/dem/setsm/REMA/mosaic/v2.0/32m/38_12/">https://data.pgc.umn.edu/elev/dem/setsm/REMA/mosaic/v2.0/32m/38_12/</a>. It is this DEM we will use for this example.
Download the folder and extract the contents to a folder of your choosing. Specify the path to the <code class="docutils literal notranslate"><span class="pre">.tif</span></code> file in the
<code class="docutils literal notranslate"><span class="pre">dem_path</span></code> variable in <code class="docutils literal notranslate"><span class="pre">model_setup.py</span></code>.</p>
<p>We also need to use some meteorological data to drive the model. An example dataset can be found in the <code class="docutils literal notranslate"><span class="pre">data</span></code> folder
of the MONARCHS repository. This is a one-year ERA5 dataset, encompassing the area used in the DEM.
Specify the path to this file in <code class="docutils literal notranslate"><span class="pre">met_input_path</span></code>. For more information on the input meteorological data, see
<a class="reference internal" href="met_data.html"><span class="doc">Formatting input meteorological data</span></a>.</p>
<p>This is all of the information you need to run the model with the George VI ice shelf.
It will take some time for the initial conditions to be set up, as the DEM is at very high resolution and requires
interpolation to fit the model domain. The actual running of the model will also be slow. However, you may notice that
it is faster than the Gaussian test case when running with the same model size. This is because of a few parameters
that exist within this version of the model setup script that are used to handle DEM data. These are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">firn_max_height</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">firn_min_height</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">max_height_handler</span> <span class="o">=</span> <span class="s2">&quot;filter&quot;</span>
<span class="n">min_height_handler</span> <span class="o">=</span> <span class="s2">&quot;extend&quot;</span>
</pre></div>
</div>
<p>A DEM of a real ice shelf will have a large range of values. MONARCHS is designed for modelling ice shelves, but the
DEM we have loaded in also contains lots of actual land in addition to the ice shelf. These parameters are used to handle
this. The land is much higher than the ice shelf - therefore we set the <code class="docutils literal notranslate"><span class="pre">firn_max_height</span></code> parameter to 100, alongside
the <code class="docutils literal notranslate"><span class="pre">max_height_handler</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">'filter'</span></code> to tell MONARCHS
that anything in the initial firn profile above 100 metres should be filtered out. This sets a flag in the <code class="docutils literal notranslate"><span class="pre">IceShelf</span></code>
class used to contain the model data (see <a class="reference internal" href="structure.html"><span class="doc">Code structure</span></a> for more information on this, or see the API reference).
This flag is called <code class="docutils literal notranslate"><span class="pre">valid_cell</span></code>. If this flag is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then MONARCHS ignores the cell entirely, no single-column
physics can run on it, and no water can flow to or from it.</p>
<p>We also have a situation where the data is say in metres above sea level, which can cause some values to be very low.
In order to run the single-column physics effectively, we need to ensure that the firn profile is at least 35 metres deep.
The <code class="docutils literal notranslate"><span class="pre">extend</span></code> option in the <code class="docutils literal notranslate"><span class="pre">min_height_handler</span></code> parameter tells MONARCHS to increase the lowest point in the DEM
up to 35m (if it is below this value), and increasing every other cell by the same amount.</p>
<p>Other options to this can be found in the <a class="reference internal" href="model_setup_reference.html"><span class="doc">model_setup variable reference</span></a>.</p>
<section id="selecting-a-subset-of-the-dem">
<h2>Selecting a subset of the DEM<a class="headerlink" href="#selecting-a-subset-of-the-dem" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="MONARCHS_model_setup.html" class="btn btn-neutral float-left" title="Setting up your own model run" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plots.html" class="btn btn-neutral float-right" title="Generating plots" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sammie Buzzard, Jon Elsey and Alex Robel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>